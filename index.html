<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Yay! Yay! Yay! Yay! - Mastermind Mode</title>
  <style>
    body { background:#111; color:#fff; font-family:sans-serif; text-align:center; }
    h1 { font-size:2em; }
    #game { display:flex; flex-direction:column; align-items:center; }
    #circleBox, #slots { display:flex; gap:10px; background:#222; padding:10px; border-radius:8px; margin:10px; }
    .circle { border-radius:50%; color:#000; font-size:12px; display:flex; align-items:center; justify-content:center; cursor:grab; }
    .slot { width:60px; height:60px; border:2px dashed #555; border-radius:6px; display:flex; align-items:center; justify-content:center; color:#888; }
    #submit { background:#0f0; color:#000; padding:10px 20px; border:none; border-radius:5px; cursor:pointer; margin:10px; font-size:18px; }
    #history { width:400px; background:#222; padding:10px; border-radius:8px; margin-top:10px; }
    .historyRow { display:flex; justify-content:space-between; margin-bottom:5px; }
    .feedback { font-size:14px; }
    .dot { width:12px; height:12px; border-radius:50%; display:inline-block; margin:2px; }
    .green { background:#0f0; }
    .yellow { background:#ff0; }
    .gray { background:#555; }
    #message { font-size:24px; margin:10px; }
    @media (max-width: 600px) {
            #container {
                gap: 10px;
            }
            .circleBox, .slots {
                width: 100%;
                max-width: none;
            }
            canvas {
                width: 100%;
                max-height: 50vh;
            }
        }
  </style>
</head>
<body>
    <img src="logo.png" alt="Yay! Yay! Yay! Yay!" style="width: 800px; height: 80px;">
<div id="game">
  <div id="circleBox"></div>
  <div id="slots"></div>
  <button id="submit">Submit Guess</button>
  <canvas id="canvas" width="400" height="400"></canvas>
  <div id="message"></div>
  <div id="history"><strong>Guess History</strong></div>
</div>

<script>
// ----- Example Level -----
const level = {
  target: [
    {id:"c1", color:"#0f0", r:80, f:1, p:0},
    {id:"c2", color:"#ff0", r:40, f:-1, p:1.2},
    {id:"c3", color:"#0ff", r:30, f:2, p:0.5},
    {id:"c4", color:"#f0f", r:20, f:-2, p:2.1},
    {id:"c5", color:"#fa0", r:15, f:3, p:0.8},
    {id:"c6", color:"#f33", r:10, f:-4, p:1.5}
  ],
  decoys: [
    {id:"d1", color:"#f44", r:50, f:3, p:0.7},
    {id:"d2", color:"#4af", r:25, f:-3, p:1.5}
  ]
};

const circles = [...level.target, ...level.decoys].sort(()=>Math.random()-0.5);
const solutionIDs = level.target.map(c=>c.id);

const box = document.getElementById("circleBox");
const slots = document.getElementById("slots");
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");
const message = document.getElementById("message");
const history = document.getElementById("history");

// ---- Build UI ----
circles.forEach(c=>{
  const div = document.createElement("div");
  div.className = "circle";
  const size = Math.max(30, Math.min(70, c.r*0.4));
  div.style.width = size+"px";
  div.style.height = size+"px";
  div.style.background = c.color;
  div.innerText = c.id;
  div.draggable = true;
  div.dataset.id = c.id;
  div.addEventListener("dragstart",e=>e.dataTransfer.setData("id",c.id));
  box.appendChild(div);
});

for(let i=0;i<solutionIDs.length;i++){
  const s = document.createElement("div");
  s.className="slot";
  s.addEventListener("dragover",e=>e.preventDefault());
  s.addEventListener("drop",e=>{
    e.preventDefault();
    const id = e.dataTransfer.getData("id");
    s.innerText = id;
    s.dataset.id = id;
    s.style.border="2px solid #fff";
  });
  slots.appendChild(s);
}

// ---- Feedback Evaluation ----
function evaluateGuess(guessIDs){
  let correctPlace = 0, correctWrongPlace = 0;
  const remaining = [...solutionIDs];
  
  // Exact matches
  guessIDs.forEach((id,i)=>{
    if(id===solutionIDs[i]){
      correctPlace++;
      remaining[i]=null;
    }
  });
  
  // Correct but wrong place
  guessIDs.forEach((id,i)=>{
    if(id!==solutionIDs[i] && remaining.includes(id)){
      correctWrongPlace++;
      remaining[remaining.indexOf(id)] = null;
    }
  });
  
  return {correctPlace, correctWrongPlace};
}

// ---- Guess Handling ----
document.getElementById("submit").addEventListener("click",()=>{
  const guess = Array.from(slots.children).map(s=>s.dataset.id || "");
  if(guess.includes("")){ message.innerText="Fill all slots!"; return; }

  const result = evaluateGuess(guess);
  addHistory(guess,result);

  if(result.correctPlace === solutionIDs.length){
    message.innerText="üéâ Correct! You Win!";
  } else {
    message.innerText=`‚úîÔ∏è ${result.correctPlace} correct & placed, ‚ö†Ô∏è ${result.correctWrongPlace} correct but wrong place.`;
  }
});

// ---- History UI ----
function addHistory(guess,result){
  const row = document.createElement("div");
  row.className="historyRow";
  
  const guessStr = guess.join(" ");
  const feedback = document.createElement("span");
  
  // dots for feedback
  let dots="";
  dots += "‚óè".repeat(result.correctPlace);
  dots += "‚óã".repeat(result.correctWrongPlace);
  dots += "‚óå".repeat(solutionIDs.length - result.correctPlace - result.correctWrongPlace);
  
  feedback.className="feedback";
  feedback.innerText = dots;
  
  row.innerHTML=`<span>${guessStr}</span>`;
  row.appendChild(feedback);
  history.appendChild(row);
}

// ---- Canvas Draw ----
let t=0;
function draw(){
  ctx.clearRect(0,0,400,400);
  ctx.save(); ctx.translate(200,200);
  
  // faint target outline
  ctx.strokeStyle="rgba(0,255,255,0.2)";
  ctx.beginPath();
  let pts=[];
  for(let i=0;i<300;i++){
    const tt=i/300*Math.PI*2;
    let pos={x:0,y:0};
    level.target.forEach(c=>{
      pos.x+=c.r*Math.cos(c.f*tt+c.p);
      pos.y+=c.r*Math.sin(c.f*tt+c.p);
    });
    pts.push(pos);
  }
  ctx.moveTo(pts[0].x,pts[0].y);
  pts.forEach(p=>ctx.lineTo(p.x,p.y));
  ctx.stroke();
  
  ctx.restore();
  t+=0.01;
  requestAnimationFrame(draw);
}
draw();
</script>
</body>
</html>